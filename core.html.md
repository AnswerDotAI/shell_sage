# Core


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Imports

## Model Setup

## System Environment

``` python
# aliases = _aliases('bash')
# print(aliases)
```

``` python
# print(_sys_info())
```

## Tmux

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L122"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_pane

>  get_pane (n, pid=None)

*Get output from a tmux pane*

``` python
# p = get_pane(20)
# print(p[:512])
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L129"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_panes

>  get_panes (n)

``` python
# ps = get_panes(20)
# print(ps[:512])
```

``` python
co(['tmux', 'display-message', '-p', '#{history-limit}'], text=True).strip()
```

    '2000'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L135"
target="_blank" style="float:right; font-size:smaller">source</a>

### tmux_history_lim

>  tmux_history_lim ()

``` python
tmux_history_lim()
```

    2000

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L141"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_history

>  get_history (n, pid='current')

## Options and ShellSage

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L150"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_opts

>  get_opts (**opts)

``` python
# opts = get_opts(model=None, log=None, api_base=None, api_key=''); opts
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L157"
target="_blank" style="float:right; font-size:smaller">source</a>

### with_permission

>  with_permission (action_desc)

``` python
print(tools[1]('.'))
```

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Directory contents of <span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">nbs</span>:
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CNAME</span>
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_quarto.yml</span>
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">nbdev.yml</span>
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">styles.css</span>
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">01_config.ipynb</span>
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">index.ipynb</span>
<span style="color: #800080; text-decoration-color: #800080">/home/natedawg/aai-ws/shell_sage/nbs/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">00_core.ipynb</span>
</pre>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L186"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_sage

>  get_sage (model, mode='default', search=False)

``` python
m = 'ollama_chat/qwen3:8b'
ssage = get_sage(m)
ssage('Howdy!')
```

<think> Okay, the user said ‚ÄúHowdy!‚Äù which is a friendly greeting. I
need to respond in a welcoming manner. Since there‚Äôs no specific query
or command requested, I should just greet them back and offer help. Let
me make sure to keep the tone friendly and educational. Maybe add an
emoji to keep it approachable. No need for any function calls here since
they‚Äôre just saying hello. Alright, time to reply. </think>

Howdy! üòä I‚Äôm ShellSage, your command-line teaching assistant. How can I
help you master shell commands and system administration? Just ask away!

<details>

- id: `chatcmpl-c0d4b4c4-6058-4e27-be10-d43194b6f46d`
- model: `ollama_chat/qwen3:8b`
- finish_reason: `stop`
- usage:
  `Usage(completion_tokens=124, prompt_tokens=940, total_tokens=1064, completion_tokens_details=None, prompt_tokens_details=None)`

</details>

``` python
m = 'claude-sonnet-4-20250514'
ssage = get_sage(m, search='l')
ssage('Hi, how are ya?')
```

Hey there! I‚Äôm doing great and ready to help you with shell commands and
system administration tasks!

Whether you need help with: - **Command syntax** and usage - **File
operations** and text processing - **System monitoring** and
troubleshooting - **Scripting** and automation - **Understanding command
output** or error messages

Just let me know what you‚Äôre working on or what you‚Äôd like to learn.
Feel free to share any command output, file contents, or specific
problems you‚Äôre facing - I‚Äôm here to help you master the command line!
üêö

What can I help you with today?

<details>

- id: `chatcmpl-70da748f-9164-4692-849d-96e7bf0d22ae`
- model: `claude-sonnet-4-20250514`
- finish_reason: `stop`
- usage:
  `Usage(completion_tokens=138, prompt_tokens=3099, total_tokens=3237, completion_tokens_details=None, prompt_tokens_details=PromptTokensDetailsWrapper(audio_tokens=None, cached_tokens=0, text_tokens=None, image_tokens=None), cache_creation_input_tokens=0, cache_read_input_tokens=0)`

</details>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L189"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_res

>  get_res (sage, q, opts)

``` python
print(Markdown(get_res(ssage, 'Hi!', opts)))
```

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Hello! üëã                                                                                                          
&#10;I'm ShellSage, your command-line teaching assistant. I'm here to help you learn and master shell commands, system  
administration, and anything related to working in the terminal.                                                   
&#10;What would you like to work on today? You can:                                                                     
&#10;<span style="color: #808000; text-decoration-color: #808000; font-weight: bold"> ‚Ä¢ </span>Ask about specific commands or their usage                                                                      
<span style="color: #808000; text-decoration-color: #808000; font-weight: bold"> ‚Ä¢ </span>Share command output or file contents you need help understanding                                               
<span style="color: #808000; text-decoration-color: #808000; font-weight: bold"> ‚Ä¢ </span>Get help troubleshooting system issues                                                                          
<span style="color: #808000; text-decoration-color: #808000; font-weight: bold"> ‚Ä¢ </span>Learn about scripting and automation                                                                            
<span style="color: #808000; text-decoration-color: #808000; font-weight: bold"> ‚Ä¢ </span>Or just ask any shell/system administration question!                                                           
&#10;What's on your mind?                                                                                               
</pre>

``` python
print(Markdown(get_res(ssage, 'Please use your view command to see what files are in the current directory. Only respond with a single paragraph', opts)))
```

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">The current directory contains several configuration and documentation files for what appears to be a Python       
project using nbdev, including Jupyter notebooks (<span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">01_config.ipynb</span>, <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">index.ipynb</span>, <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">00_core.ipynb</span>), configuration files
(<span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">_quarto.yml</span>, <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">nbdev.yml</span>), a custom stylesheet (<span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">styles.css</span>), and a <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">CNAME</span> file likely for GitHub Pages hosting - you 
could explore these files using commands like <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">cat</span> for text files or <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">jupyter notebook</span> to open the <span style="color: #008080; text-decoration-color: #008080; background-color: #000000; font-weight: bold">.ipynb</span> files.     
</pre>

``` python
print(Markdown(get_res(ssage, 'Please search the web for interesting facts about Linux. Only respond with a single paragraph.', opts)))
```

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Here are some fascinating facts about Linux that showcase its incredible impact on technology: <a href="https://www.geeksforgeeks.org/interesting-facts-about-linux/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://jasoneckert.github.io/myblog/linux-fun-facts/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> The first Linux 
kernel was only 65 KB in size, yet today <a href="https://www.geeksforgeeks.org/interesting-facts-about-linux/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://jasoneckert.github.io/myblog/linux-fun-facts/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> it has grown to over 30 million lines of code, making it <a href="https://www.omgubuntu.co.uk/2018/08/interesting-facts-about-linux" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://www.omgubuntu.co.uk/2018/08/interesting-facts-about-linux" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> the      
single largest open source project on the planet. <a href="https://www.geeksforgeeks.org/interesting-facts-about-linux/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://www.geeksforgeeks.org/interesting-facts-about-linux/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://jasoneckert.github.io/myblog/linux-fun-facts/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> All of the top 500 fastest supercomputers run Linux, and it
powers everything from <a href="https://www.geeksforgeeks.org/interesting-facts-about-linux/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://www.omgubuntu.co.uk/2018/08/interesting-facts-about-linux" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> smartphones and servers to submarines and space rockets, with <a href="https://www.omgubuntu.co.uk/2018/08/interesting-facts-about-linux" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> <a href="https://itsfoss.com/facts-linux-kernel/" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> NASA, SpaceX, and the 
International Space Station all relying on Linux. Interestingly, <a href="https://www.omgubuntu.co.uk/2018/08/interesting-facts-about-linux" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> Linux almost wasn't called Linux - Linus        
Torvalds originally wanted to name it "Freax" but was convinced otherwise, and <a href="https://en.wikipedia.org/wiki/Linux" target="_blank"><span style="color: #000080; text-decoration-color: #000080; text-decoration: underline">*</span></a> the film industry has embraced    
Linux so thoroughly that over 95% of servers at major animation companies use it, starting with Titanic in 1997.   
</pre>

## Logging

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L198"
target="_blank" style="float:right; font-size:smaller">source</a>

### mk_db

>  mk_db ()

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L195"
target="_blank" style="float:right; font-size:smaller">source</a>

### Log

>  Log ()

*Initialize self. See help(type(self)) for accurate signature.*

``` python
# db = mk_db()
# log = db.logs.insert(Log(timestamp=datetime.now().isoformat(), query='Hi, who are you?', model='llama3.2',
#                          response='I am ShellSage, a command-line teaching assistant!', mode='default'))
# log
```

## Main

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L206"
target="_blank" style="float:right; font-size:smaller">source</a>

### main

>  main (query:str<ThequerytosendtotheLLM>, v:<Printversion>='%(prog)s
>            1.0.1', pid:str='current', skip_system:bool=False,
>            history_lines:int=None, mode:str='default', model:str=None,
>            search:str=None, api_base:str=None, api_key:str=None,
>            code_theme:str=None, code_lexer:str=None)

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>str <The query to send to the LLM></td>
<td></td>
<td></td>
</tr>
<tr>
<td>v</td>
<td><Print version></td>
<td>%(prog)s 1.0.1</td>
<td></td>
</tr>
<tr>
<td>pid</td>
<td>str</td>
<td>current</td>
<td><code>current</code>, <code>all</code> or tmux pane_id (e.g.¬†%0) for
context</td>
</tr>
<tr>
<td>skip_system</td>
<td>bool</td>
<td>False</td>
<td>Whether to skip system information in the AI‚Äôs context</td>
</tr>
<tr>
<td>history_lines</td>
<td>int</td>
<td>None</td>
<td>Number of history lines. Defaults to tmux scrollback history
length</td>
</tr>
<tr>
<td>mode</td>
<td>str</td>
<td>default</td>
<td>Available ShellSage modes: [‚Äòdefault‚Äô, ‚Äòsassy‚Äô]</td>
</tr>
<tr>
<td>model</td>
<td>str</td>
<td>None</td>
<td>The LLM model that will be invoked on the LLM provider</td>
</tr>
<tr>
<td>search</td>
<td>str</td>
<td>None</td>
<td>Wheather to allow the LLM to search the internet</td>
</tr>
<tr>
<td>api_base</td>
<td>str</td>
<td>None</td>
<td></td>
</tr>
<tr>
<td>api_key</td>
<td>str</td>
<td>None</td>
<td></td>
</tr>
<tr>
<td>code_theme</td>
<td>str</td>
<td>None</td>
<td>The code theme to use when rendering ShellSage‚Äôs responses</td>
</tr>
<tr>
<td>code_lexer</td>
<td>str</td>
<td>None</td>
<td>The lexer to use for inline code markdown blocks</td>
</tr>
</tbody>
</table>

``` python
main('Teach me about rsync. Reply with a single paragraph.', history_lines=0)
```

    bash: cannot set terminal process group (25798): Inappropriate ioctl for device
    bash: no job control in this shell

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">rsync is a fast, incremental file copy and synchronization tool that compares files (by size and mtime by default) 
and transfers only the differences, locally or over the network (commonly via SSH), making backups and mirroring   
efficient; key options include -a ‚Äúarchive‚Äù mode (preserves permissions, ownership, times, symlinks), -v for       
verbosity, -h for human-readable sizes, -n for a dry run (great for previewing changes), -z to compress data in    
transit, -P for progress/partial transfers, and -c to verify by checksum (slower but safer); it supports powerful  
filtering with --include/--exclude and files via --exclude-from, and understands trailing slash semantics (src/    
syncs contents, src syncs the directory itself); use -A and -X to preserve ACLs and xattrs, -H for hard links, and 
note that preserving owners/permissions across systems may require sudo; the remote form (host:path) uses SSH by   
default, and you can tune it with -e ssh or SSH options; <span style="font-weight: bold">be cautious with --delete</span>, which removes destination files
not present at the source; see documentation with man rsync or rsync --help for full details and examples.         
</pre>

```` python
r = f'''
Hello, user! Here are some code blocks:

```python
for i in range(10): print(i)
```

```
This doesn't even have a language definition!
```

```bash
ls **/*
```
'''
````

``` python
db = mk_db()
db.logs.insert(Log(timestamp=datetime.now().isoformat(), query='', response=r, model='', mode=''))
```

    Log(id=36, timestamp='2025-10-07T17:51:16.549279', query='', response="\nHello, user! Here are some code blocks:\n\n```python\nfor i in range(10): print(i)\n```\n\n```\nThis doesn't even have a language definition!\n```\n\n```bash\nls **/*\n```\n", model='', mode='')

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L256"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_cf

>  extract_cf (idx)

``` python
extract_cf(0)
```

    'for i in range(10): print(i)'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/shell_sage/blob/main/shell_sage/core.py#L260"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract

>  extract (idx:int, copy:bool=False)

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>idx</td>
<td>int</td>
<td></td>
<td>Index of code block to extract</td>
</tr>
<tr>
<td>copy</td>
<td>bool</td>
<td>False</td>
<td>Copy to clipboard vs send to tmux</td>
</tr>
</tbody>
</table>
